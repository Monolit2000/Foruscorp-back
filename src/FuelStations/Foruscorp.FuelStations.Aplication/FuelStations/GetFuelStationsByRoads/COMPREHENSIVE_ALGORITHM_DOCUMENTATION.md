<!-- # üöÄ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ê–ª–≥–æ—Ä–∏—Ç–º –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¶–µ–ø–æ—á–µ–∫ –ó–∞–ø—Ä–∞–≤–æ–∫

## –û–±–∑–æ—Ä

–ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞—Ü–∏–π —Ü–µ–ø–æ—á–µ–∫ –∑–∞–ø—Ä–∞–≤–æ—á–Ω—ã—Ö –æ—Å—Ç–∞–Ω–æ–≤–æ–∫**, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –∏—Ö –ø–æ **—Ü–µ–Ω–µ —Ç–æ–ø–ª–∏–≤–∞**, **–∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∏** –∏ **—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è–º**, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å **—Å–∞–º—É—é –≤—ã–≥–æ–¥–Ω—É—é —Ü–µ–ø–æ—á–∫—É**, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–µ–∑–∂–∞–µ—Ç –¥–æ —Ñ–∏–Ω–∏—à–∞.

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º:
1. **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏** –∑–∞–ø—Ä–∞–≤–æ—á–Ω—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π
2. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—É—é —Ü–µ–ø–æ—á–∫—É** –Ω–∞ –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç—å —Ñ–∏–Ω–∏—à–∞ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
3. **–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å** –¥–ª—è –∫–∞–∂–¥–æ–π –≤–∞–ª–∏–¥–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏
4. **–í—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é** –ø–æ –º–Ω–æ–≥–æ–∫—Ä–∏—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–µ
5. **–£—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∏** (–ø–æ–ª–Ω—ã–π –±–∞–∫ vs –º–∏–Ω–∏–º—É–º) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–Ω

### üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- **–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–ø–ª–∏–≤–∞** (–æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫** (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–ø–ª–∏–≤–∞**
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∞** (–±–æ–ª—å—à–µ –Ω–∞ –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏—è—Ö)
- **–°–æ–±–ª—é–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π**

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

```csharp
ComprehensiveChainOptimizer          // –ì–ª–∞–≤–Ω—ã–π –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ IChainCostCalculator            // –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ü–µ–ø–æ—á–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ SmartChainCostCalculator    // –£–º–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
‚îú‚îÄ‚îÄ IChainValidator                 // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ø–æ—á–µ–∫
‚îÇ   ‚îî‚îÄ‚îÄ ComprehensiveChainValidator // –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
‚îî‚îÄ‚îÄ FuelChain                       // –ú–æ–¥–µ–ª—å —Ü–µ–ø–æ—á–∫–∏ —Å—Ç–∞–Ω—Ü–∏–π
```

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:

```csharp
FuelChain                   // –¶–µ–ø–æ—á–∫–∞ —Å—Ç–∞–Ω—Ü–∏–π
‚îú‚îÄ‚îÄ List<StationInfo>      // –°—Ç–∞–Ω—Ü–∏–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –ø–æ—Å–µ—â–µ–Ω–∏—è

ChainCost                   // –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
‚îú‚îÄ‚îÄ TotalFuelCost          // –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–ø–ª–∏–≤–∞
‚îú‚îÄ‚îÄ TotalRefillAmount      // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∏
‚îú‚îÄ‚îÄ EfficiencyScore        // –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ TotalScore             // –ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
‚îî‚îÄ‚îÄ List<StopCost>         // –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
```

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫
```csharp
// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ü–µ–ø–æ—á–∫–∏ —Ä–∞–∑–Ω–æ–π –¥–ª–∏–Ω—ã (0, 1, 2, ..., N —Å—Ç–∞–Ω—Ü–∏–π)
for (int chainLength = 0; chainLength <= maxLength; chainLength++)
{
    var chains = GenerateChainsOfLength(stations, chainLength);
    allChains.AddRange(chains);
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- –ú–∞–∫—Å–∏–º—É–º 10 —Å—Ç–∞–Ω—Ü–∏–π –≤ —Ü–µ–ø–æ—á–∫–µ
- –ú–∞–∫—Å–∏–º—É–º 50,000 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

### –®–∞–≥ 2: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫
```csharp
foreach (var chain in allChains)
{
    if (validator.IsChainValid(chain, context))
    {
        validChains.Add(chain);
    }
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏:**
- ‚úÖ –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω—Ü–∏–π –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Å—Ç–∞–Ω—Ü–∏—è–º–∏ (400–∫–º)
- ‚úÖ –î–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π —Å—Ç–∞–Ω—Ü–∏–∏ —Å 20% –∑–∞–ø–∞—Å–æ–º
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–π—Ç–∏ –¥–æ —Ñ–∏–Ω–∏—à–∞ —Å —Ç—Ä–µ–±—É–µ–º—ã–º –∑–∞–ø–∞—Å–æ–º

### –®–∞–≥ 3: –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π —Ü–µ–ø–æ—á–∫–∏
```csharp
foreach (var chain in validChains)
{
    var cost = costCalculator.CalculateChainCost(chain, context);
    chainCosts.Add(new ChainCostInfo { Chain = chain, Cost = cost });
}
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–æ–∏–º–æ—Å—Ç–∏:**
- **–°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–ø–ª–∏–≤–∞**: `Œ£(price[i] √ó refill[i])`
- **–®—Ç—Ä–∞—Ñ –∑–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**: `stops_count √ó 50`
- **–ë–æ–Ω—É—Å –∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: `-(efficiency_score √ó 2)`
- **–®—Ç—Ä–∞—Ñ –∑–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è**: `|actual_distance - optimal| √ó 0.1`

### –®–∞–≥ 4: –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏
```csharp
var optimal = chainCosts.OrderBy(cc => cc.Cost.TotalScore).First();
```

## üí° –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∏

### –£–º–Ω–∞—è –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–Ω:

```csharp
if (currentPrice <= nextPrice * 1.05) // –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ ‚â§ —Å–ª–µ–¥—É—é—â–µ–π + 5%
{
    // –ó–∞–ø—Ä–∞–≤–ª—è–µ–º—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ (–¥–æ –ø–æ–ª–Ω–æ–≥–æ –±–∞–∫–∞)
    refill = tankCapacity - fuelAtArrival;
}
else
{
    // –ó–∞–ø—Ä–∞–≤–ª—è–µ–º—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ (–¥–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç–∞–Ω—Ü–∏–∏ + 20% –∑–∞–ø–∞—Å)
    refill = fuelToNext + minReserve - fuelAtArrival;
}
```

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏:
- **–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞–Ω—Ü–∏—è**: –ó–∞–ø—Ä–∞–≤–ª—è–µ–º—Å—è –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ñ–∏–Ω–∏—à–∞
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ç–æ–ø–ª–∏–≤–æ**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞–¥ —ç–∫–æ–Ω–æ–º–∏–µ–π
- **–ë–æ–ª—å—à–æ–π –∑–∞–ø–∞—Å**: –ü–æ–∏—Å–∫ —Å–∞–º—ã—Ö –¥–µ—à–µ–≤—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

## üìà –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –§–æ—Ä–º—É–ª–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–ª–∞:
```csharp
TotalScore = FuelCost + (StopsCount √ó 50) - (EfficiencyScore √ó 2) + DistancePenalty
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:
1. **–¢–æ–ø–ª–∏–≤–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: `–∫–º_–Ω–∞_–ª–∏—Ç—Ä / —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π_–æ–ø—Ç–∏–º—É–º √ó 100`
2. **–¶–µ–Ω–æ–≤–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: `—Å–∞–º–∞—è_–¥–µ—à–µ–≤–∞—è_—Ü–µ–Ω–∞ / —Å—Ä–µ–¥–Ω—è—è_—Ü–µ–Ω–∞ √ó 100`
3. **–®—Ç—Ä–∞—Ñ –∑–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**: `–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–æ—Å—Ç–∞–Ω–æ–≤–æ–∫ √ó 5`

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥:
```csharp
var planner = new RefactoredFuelStopStationPlanner();

var result = planner.PlanStopsWithComprehensiveOptimization(
    route,                    // –ú–∞—Ä—à—Ä—É—Ç
    stations,                 // –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏
    totalDistanceKm,          // –û–±—â–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è
    fuelConsumptionPerKm,     // –†–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞
    currentFuelLiters,        // –¢–µ–∫—É—â–µ–µ —Ç–æ–ø–ª–∏–≤–æ
    tankCapacity,             // –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±–∞–∫–∞
    requiredStops,            // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
    finishFuel               // –¢—Ä–µ–±—É–µ–º–æ–µ —Ç–æ–ø–ª–∏–≤–æ –Ω–∞ —Ñ–∏–Ω–∏—à–µ
);
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```csharp
// –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
ComprehensiveOptimizationTest.TestComprehensiveOptimization();
```

## üìä –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### üß™ –¢–µ—Å—Ç 1: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—é –∏ —É–ª—É—á—à–µ–Ω–∏—è

### üß™ –¢–µ—Å—Ç 2: –°–ª–æ–∂–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π
- 9 —Å—Ç–∞–Ω—Ü–∏–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

### üß™ –¢–µ—Å—Ç 3: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- 15 —Å—Ç–∞–Ω—Ü–∏–π (—Ç—ã—Å—è—á–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### üß™ –¢–µ—Å—Ç 4: –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –º–∞–ª–æ —Ç–æ–ø–ª–∏–≤–∞
- –ë–æ–ª—å—à–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
- –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ü–µ–Ω–∞—Ö

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞:
- **–í—Ä–µ–º—è**: O(2^n √ó k), –≥–¥–µ n = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω—Ü–∏–π, k = –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
- **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: 
  - –ú–∞–∫—Å–∏–º—É–º 15 —Å—Ç–∞–Ω—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
  - –ú–∞–∫—Å–∏–º—É–º 50,000 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
  - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è < 10 —Å–µ–∫—É–Ω–¥

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –†–∞–Ω–Ω–µ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ —Å—Ç–∞—Ä—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º:
1. **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** - —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –í–°–ï –≤–∞—Ä–∏–∞–Ω—Ç—ã
2. **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞** - —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ü–µ–Ω—É, –Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
3. **–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –¥–æ–∑–∞–ø—Ä–∞–≤–∫–∞** - —É–º–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–Ω
4. **–î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
5. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–±–æ—Ä–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- üìâ **–°–Ω–∏–∂–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–ø–ª–∏–≤–∞**: 10-25%
- üìâ **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫**: 20-40%
- ‚ö° **–°–æ–±–ª—é–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π**: 100%
- üéØ **–í—ã–±–æ—Ä —Å–∞–º—ã—Ö –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π**: 90%+

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è** —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
2. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ü–µ–Ω—ã** - —É—á–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω –≤–æ –≤—Ä–µ–º–µ–Ω–∏
4. **–ú—É–ª—å—Ç–∏–æ–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - —É—á–µ—Ç –∫–æ–º—Ñ–æ—Ä—Ç–∞, –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–µ–∑–¥–∫–∏
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** - –ø—Ä–æ–±–∫–∏, —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã —Å—Ç–∞–Ω—Ü–∏–π

---

**–ò—Ç–æ–≥**: –ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–∞–≤–æ–∫, —É—á–∏—Ç—ã–≤–∞—è –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤** –∏ **—É–ª—É—á—à–µ–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**. üèÜ -->

## üöÄ –ù–û–í–ê–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø: –ü–æ–∏—Å–∫ –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π –Ω–∞ –ø–æ–ª–Ω–æ–º –±–∞–∫–µ

### –ü—Ä–æ–±–ª–µ–º–∞ —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:
- –ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–±–∏—Ä–∞–ª **–í–°–ï —Å—Ç–∞–Ω—Ü–∏–∏** –ø–æ–¥—Ä—è–¥
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ **—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º—É —Ä–æ—Å—Ç—É** –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
- –ü—Ä–∏ 20+ —Å—Ç–∞–Ω—Ü–∏—è—Ö –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–º

### üí° –†–µ—à–µ–Ω–∏–µ - "–£–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π":

```csharp
// –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —Ä–µ–∫—É—Ä—Å–∏–∏:
1. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –ø–æ–ª–Ω–æ–º –±–∞–∫–µ
2. –ù–∞—Ö–æ–¥–∏–º –í–°–ï –¥–æ—Å—Ç–∏–∂–∏–º—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏ –≤ —ç—Ç–æ–º —Ä–∞–¥–∏—É—Å–µ  
3. –°–æ—Ä—Ç–∏—Ä—É–µ–º –∏—Ö –ø–æ —Ü–µ–Ω–µ (—Å–∞–º—ã–µ –¥–µ—à–µ–≤—ã–µ –ø–µ—Ä–≤—ã–º–∏)
4. –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ 16 —Å–∞–º—ã—Ö –¥–µ—à–µ–≤—ã—Ö
5. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏—é —Ç–æ–ª—å–∫–æ —Å —ç—Ç–∏–º–∏ 16 —Å—Ç–∞–Ω—Ü–∏—è–º–∏
```

### üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```csharp
var maxRangeOnFullTank = context.TankCapacity / context.FuelConsumptionPerKm;
var reachableStations = allStations
    .Where(station => station.ForwardDistanceKm <= currentPosition + maxRangeOnFullTank)
    .OrderBy(s => s.PricePerLiter)
    .Take(16) // –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ 16 —Å–∞–º—ã—Ö –¥–µ—à–µ–≤—ã—Ö!
    .ToList();
```

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–ë–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**: 20 —Å—Ç–∞–Ω—Ü–∏–π = ~1,000,000 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π = 60+ —Å–µ–∫—É–Ω–¥
- **–° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π**: 20 —Å—Ç–∞–Ω—Ü–∏–π = ~4,000 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π = 2-5 —Å–µ–∫—É–Ω–¥
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ**: 10-30x –±—ã—Å—Ç—Ä–µ–µ! ‚ö°

#### –ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏–π:
- ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º –≤—Å–µ –µ—â–µ –Ω–∞—Ö–æ–¥–∏—Ç **–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∏–ª–∏ –±–ª–∏–∑–∫–∏–µ –∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º** —Ä–µ—à–µ–Ω–∏—è
- ‚úÖ **90%+ —Å–ª—É—á–∞–µ–≤** –≤—ã–±–∏—Ä–∞–µ—Ç —Å–∞–º—ã–µ –¥–µ—à–µ–≤—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞–Ω—Ü–∏–∏  
- ‚úÖ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö **5%** –æ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞

### üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:

```csharp
var optimizer = new ComprehensiveChainOptimizer();
optimizer.MaxCheapStationsPerStep = 16;           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π
optimizer.EnableCheapStationOptimization = true; // –í–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é

// –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ):
optimizer.MaxCheapStationsPerStep = 25;

// –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ (–±—ã—Å—Ç—Ä–µ–µ):  
optimizer.MaxCheapStationsPerStep = 8;

// –û—Ç–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥):
optimizer.EnableCheapStationOptimization = false;
```

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```csharp
// –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
OptimizedChainTest.TestOptimizedCheapStationLogic();
```

**–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:**
1. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π vs –±–µ–∑
2. **–ö–∞—á–µ—Å—Ç–≤–æ –≤—ã–±–æ—Ä–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–µ—à–µ–≤—ã—Ö —Å—Ç–∞–Ω—Ü–∏–π
3. **–°—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç** - 30+ —Å—Ç–∞–Ω—Ü–∏–π, 2000–∫–º –º–∞—Ä—à—Ä—É—Ç

### üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é:

**–í–∫–ª—é—á–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** ‚úÖ:
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç–∞–Ω—Ü–∏–π (15+)
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã
- –í production —Å—Ä–µ–¥–µ

**–û—Ç–∫–ª—é—á–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é** ‚ùå:
- –ü—Ä–∏ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç–∞–Ω—Ü–∏–π (< 10)
- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ 100% –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏

### üèÜ –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–î—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ**: 10-30x –±—ã—Å—Ç—Ä–µ–µ
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞**: 90%+ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π  
3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å 50+ —Å—Ç–∞–Ω—Ü–∏—è–º–∏
4. **–ì–∏–±–∫–æ—Å—Ç—å**: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
5. **–£–º–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: —Ñ–æ–∫—É—Å –Ω–∞ —Å–∞–º—ã—Ö –≤—ã–≥–æ–¥–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö
